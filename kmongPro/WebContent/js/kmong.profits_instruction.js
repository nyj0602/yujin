orderCommissionPolicyVue=new Vue({el:"#profitsDiv",mounted:{},data:function(){return{rootCategories:[],subCategories:[],selectedRootCategory:1,selectedSubCategory:101,commissionPolicies:[],expectedTotalOrderPrice:"",expectedTotalOrderPriceString:"",expectedProfits:0}},watch:{commissionPolicies:function(){if(this.commissionPolicies.length>0)for(var i in this.commissionPolicies)if("object"==typeof this.commissionPolicies[i]&&(this.$set("commissionPolicies["+i+"].from_amount_string",(parseInt(this.commissionPolicies[i].from_amount)+1).format()+" 원"),0!=this.commissionPolicies[i].to_amount?this.$set("commissionPolicies["+i+"].to_amount_string",parseInt(this.commissionPolicies[i].to_amount).format()+" 원"):this.$set("commissionPolicies["+i+"].to_amount_string",""),this.$set("commissionPolicies["+i+"].expected_profits",0)),i==this.commissionPolicies.length-1)break}},filters:{number_format:function(i){return void 0!==i?i.format():0}},ready:function(){this.getOrderCommissionPolicyByCategory()},methods:{removePrice:function(){this.expectedTotalOrderPriceString="",this.expectedTotalOrderPrice="",this.expectedProfits=0;for(var i in this.commissionPolicies)if("object"==typeof this.commissionPolicies[i]&&(this.commissionPolicies[i].expected_profits=0,this.commissionPolicies[i].expected_commissions=0),i===this.commissionPolicies.length-1)break},getOrderCommissionPolicyByCategory:function(i){if(""!==this.selectedRootCategory){var e={category_id:this.selectedRootCategory,is_parent:!0};$.ajax({type:"GET",url:"/api/common/get_order_commission_policy_by_category_id",data:e,dataType:"json",success:function(e){orderCommissionPolicyVue.commissionPolicies=e.data.order_commission_policy,"undefined"!=typeof i&&i()},error:function(i){}})}},calculate:function(){if(this.expectedTotalOrderPriceString=this.expectedTotalOrderPriceString.replace(/[^0-9]/g,"").format(),this.expectedTotalOrderPrice=this.expectedTotalOrderPriceString.replace(/[^0-9]/g,""),""!=this.expectedTotalOrderPrice&&this.expectedTotalOrderPrice>=5e3){this.expectedProfits=0;for(var i in this.commissionPolicies){var e=this.commissionPolicies[i];if("object"==typeof this.commissionPolicies[i]){if(this.commissionPolicies[i].expected_commissions="undefined"!=typeof this.commissionPolicies[i].expected_commissions?this.commissionPolicies[i].expected_commissions:0,this.expectedTotalOrderPrice>e.to_amount){var o=parseInt(e.to_amount)-parseInt(e.from_amount);0==e.to_amount&&(o=this.expectedTotalOrderPrice-e.from_amount),o<0&&(o=0),this.commissionPolicies[i].expected_profits=parseInt(o*(100-e.commission)/100),this.commissionPolicies[i].expected_commissions=o-this.commissionPolicies[i].expected_profits}else if(this.expectedTotalOrderPrice<=e.to_amount){var o=parseInt(this.expectedTotalOrderPrice)-parseInt(e.from_amount);o<0&&(o=0),this.commissionPolicies[i].expected_profits=parseInt(o*(100-e.commission)/100),this.commissionPolicies[i].expected_commissions=o-this.commissionPolicies[i].expected_profits}isNaN(this.commissionPolicies[i].expected_profits)&&(this.commissionPolicies[i].expected_profits=0,this.commissionPolicies[i].expected_commissions=0),this.expectedProfits+=parseInt(this.commissionPolicies[i].expected_profits)}if(i===this.commissionPolicies.length-1)break}}else{this.expectedProfits=0;for(var i in this.commissionPolicies)if("object"==typeof this.commissionPolicies[i]&&(this.commissionPolicies[i].expected_profits=0),i===this.commissionPolicies.length-1)break}}}});